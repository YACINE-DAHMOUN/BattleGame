<doctype html>

    <html lang="en">

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>BattleGame</title>
        <base href="/" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

        <!-- CSS personnalisé (optionnel) -->
        <style>
            .text-orange {
                color: orange;
            }

            #game {
                min-height: 100vh;
                padding: 20px 0;
                background-color: #f8f9fa;
            }
        </style>

    </head>
    <body>
        <section id="heros"
                 style="background-image: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80'); height: 100vh; background-size: cover; background-position: center;">
            <div class="d-flex justify-content-center align-items-center h-100">
                <div class="text-center text-white">
                    <h1 class="mb-4">Welcome to BattleGame</h1>
                    <p class="mb-4 align-items-center  text-orange">Choose your hero and embark on an epic adventure!</p>
                    <a class="btn btn-primary btn-lg" href="#game" role="button">Start Game</a>
                </div>
            </div>
        </section>

            <section id="game" style=" display: none;">
                <div class="text-center mb-4">
                    <button class="btn btn-warning btn-lg" id="button-start">🎮 Start New Battle</button>
                </div>
                <div class="container mt-4">
                    <div class="row">
                        <div class="col-md-5">
                            <div class="card">
                                <div class="card-header"><h3>🏹 Archer</h3></div>
                                <div class="card-body" id="player-stats">
                                    <!-- Vos stats héros ici -->
                                </div>
                            </div>
                        </div>

                        <div class="col-md-2 text-center">
                            <button class="btn btn-danger mb-2" id="attack-button">⚔️ Attack</button>
                            <button class="btn btn-success" id="heal-button">💚 Heal</button>
                        </div>

                        <div class="col-md-5">
                            <div class="card">
                                <div class="card-header"><h3>👹 Goblin</h3></div>
                                <div class="card-body" id="enemy-stats">
                                    <!-- Vos stats ennemi ici -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header"><h4>📜 Battle Log</h4></div>
                                <div class="card-body" id="log-messages">
                                    <!-- Messages du combat -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    // Récupération des éléments
                    const heroSection = document.getElementById('heros');
                    const gameSection = document.getElementById('game');
                    const startGameBtn = document.querySelector('a[href="#game"]');
                    const startBattleBtn = document.getElementById('button-start');
                    const attackBtn = document.getElementById('attack-button');
                    const healBtn = document.getElementById('heal-button'); 


                    // Fonctions
                    function showGameSection() {
                        heroSection.style.display = 'none';
                        gameSection.style.display = 'block';
                    }

                    async function startNewBattle() {
                        try {
                            const response = await fetch('/game/start');
                            const data = await response.json();
                            console.log('New battle started:', data);
                            displayGameData(data);
                        } catch (error) {
                            console.error('Error starting new battle:', error);
                        }
                    }

                    async function attackEnemy() {
                        try {
                            const response = await fetch('/game/attack');
                            const data = await response.json();
                            displayGameData(data);
                            addLogMessage('⚔️ Le héros attaque !');
                        } catch (error) {
                            console.error('Erreur:', error);
                        }
                    }
                    async function healHero() {
                        try {
                            const response = await fetch('/game/heal');
                            const data = await response.json();
                            displayGameData(data);
                            addLogMessage('💚 Le héros se soigne !');
                        } catch (error) {
                            console.error('Erreur:', error);
                        }
                    }

                    // Event listeners
                    startGameBtn.addEventListener('click', function (e) {
                        e.preventDefault();
                        showGameSection();
                    });
                    startBattleBtn.addEventListener('click', startNewBattle);
                    attackBtn.addEventListener('click', attackEnemy);
                    healBtn.addEventListener('click', healHero);



                });

                

                // Fonctions en dehors du DOMContentLoaded
                function displayGameData(data) {
                    const playerStatsDiv = document.getElementById('player-stats');
                    const enemyStatsDiv = document.getElementById('enemy-stats');

                    const heroHTML = `
                                            <p><strong>❤️ PV :</strong> ${data.hero.health} / 100</p>
                                            <p><strong>⚔️ Attaque :</strong> ${data.hero.attack}</p>
                                            <p><strong>🛡️ Défense :</strong> ${data.hero.defense}</p>
                                            <p><strong>⚡ Vitesse :</strong> ${data.hero.speed}</p>
                                        `;

                    const enemyHTML = `
                                            <p><strong>❤️ PV :</strong> ${data.enemy.health} / 100</p>
                                            <p><strong>⚔️ Attaque :</strong> ${data.enemy.attack}</p>
                                            <p><strong>🛡️ Défense :</strong> ${data.enemy.defense}</p>
                                            <p><strong>⚡ Vitesse :</strong> ${data.enemy.speed}</p>
                                        `;

                    playerStatsDiv.innerHTML = heroHTML;
                    enemyStatsDiv.innerHTML = enemyHTML;
                }



                function addLogMessage(message) {
                    const logDiv = document.getElementById('log-messages');
                    const newMessage = document.createElement('p');
                    newMessage.textContent = message;
                    logDiv.appendChild(newMessage);
                }
            </script>
           
    </body>
</html>
